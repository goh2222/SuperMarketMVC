<%- include('partials/header', { pageTitle: 'Product Details' }) %>

    <div class="container">
        <p>Welcome, <%= user.username %> (<%= user.role %>)</p>
        <br>
        <div class="text-center"><h2>Product Details</h2></div>
        <br>
        <% if (product) { %> <!-- Check if product data exists -->
            <div>
                <p><b>Product Name:</b><br> <%= product.productName %></p>
                <p><b>Product Image:</b><br> <img src = "../images/<%= product.image %>" width="20%"></p>
                <p><b>Product Quantity:</b><br> <%= product.quantity %></p>
                <% const disc = (product.discount || 0) * 1; %>
                <% const discountedPrice = (isFinite(product.price) ? Number(product.price) : 0) * (1 - (isFinite(disc) ? disc / 100 : 0)); %>
                <p><b>Price:</b><br>
                  <% if (disc && disc > 0) { %>
                    <small class="text-muted"><s>$<%= product.price.toFixed(2) %></s></small>
                    <span class="ms-2"><strong>$<%= discountedPrice.toFixed(2) %></strong> <small class="text-success">(<%= disc.toFixed(2) %>% off)</small></span>
                  <% } else { %>
                    <strong>$<%= product.price.toFixed(2) %></strong>
                  <% } %>
                </p>
                <% if (product.description && String(product.description).trim().length) { %>
                  <p><b>Description:</b><br>
                    <%= product.description %>
                  </p>
                <% } %>
            </div>
        <% } else { %>
            <p>No product found.</p>
        <% } %>
        <% if (user.role === "admin") { %>
          <a href="/inventory" class="btn btn-secondary">Back</a>
        <% } else { %>
          <a href="/shopping" class="btn btn-secondary">Back</a>
        <% } %>
    </div>
    
  <%- include('partials/footer') %>
